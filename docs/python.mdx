---
name: Python guide
routeName: python
order: 2
subOrder: 2
---

### Python guide

The respository for our open source Python middleware can be found <ExternalLink href="https://github.com/apilytics/apilytics-python">here</ExternalLink>.

<br />

#### [Installation](#installation) {#installation}

Install with pip:

```sh
pip install apilytics
```

Install with poetry:

```sh
poetry add apilytics
```

Enable the middleware and set your API key:  
_A good practice is to securely store the API key as an environment variable.
You can leave the env variable unset in e.g. development and test environments,
the middleware will be automatically disabled if the key is `None`._

<br />

#### [Django](#django) {#django}

```python
# settings.py

import os

APILYTICS_API_KEY = os.getenv("APILYTICS_API_KEY")

MIDDLEWARE = [
    "apilytics.django.ApilyticsDjangoMiddleware",
]
```

<br />

#### [FastAPI](#fastapi) {#fastapi}

```python
# main.py

import os
from fastapi import FastAPI
from apilytics.fastapi import ApilyticsFastAPIMiddleware

app = FastAPI()
app.add_middleware(ApilyticsFastAPIMiddleware, api_key=os.getenv("APILYTICS_API_KEY"))
```

<br />

#### [Other Python frameworks](#other) {#other}

```python
# my_apilytics_middleware.py

import os
from apilytics.core import ApilyticsSender

def my_apilytics_middleware(request, get_response):
  with ApilyticsSender(
      api_key=os.getenv("APILYTICS_API_KEY"),
      path=request.path,
      method=request.method,
  ) as sender:
      response = get_response(request)
      sender.set_response_info(status_code=response.status_code)

  return response
```
